---
title: "Project 1: Data Exploration and Visualization"
author: "Jenny Li, Xiang Li"
date: "2021/9/17"
output: html_document
---

<!--- Begin styling code. --->
<style type="text/css">
/* Whole document: */
body{
  font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
  font-size: 12pt;
}
h1.title {
  font-size: 38px;
  text-align: center;
}
h4.author {
  font-size: 18px;
  text-align: center;
}
h4.date {
  font-size: 18px;
  text-align: center;
}
</style>
<!--- End styling code. --->
```{r,message=FALSE,echo=FALSE}
library(tidyverse)
library(splitstackshape)
```


```{r,echo=FALSE,message=FALSE}
#full_bg<-read_csv('https://raw.githubusercontent.com/bryandmartin/STAT155/master/docs/Projects/project1_bgdataviz/boa#rd_game_raw.csv')

#write_csv(full_bg,"./Data/full_bg.csv")

full_bg<- read_csv("./Data/full_bg.csv")
```
#Instruction

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#filter games published in 1950 or later and with at least 25 ratings
newFull_gb<-full_bg%>%
  filter(yearpublished>=1950,users_rated>=25)

full_gbMechanic<-newFull_gb%>%
  cSplit("category", direction="wide")

full_gbCategory<-newFull_gb%>%
  cSplit("category", direction="long")

full_gbMechanic2<-newFull_gb%>%
  cSplit("mechanic", direction="wide")

#searching for certain category(contains the word in the name)
catan<-newFull_gb%>%
  filter(grepl("Catan",name))
```


#Mian Section

>Visualization one(average compexity with the first 6 categories which contain the most games)

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#count how may games in each category
categoryCounts<-full_gbCategory%>%
  count(category)

#resorted it in the decreasing number of games in each category
newOrderCa<-categoryCounts[order(-n)]

#filter the first six category to create a new dataset
firstSixCa<-
  full_gbCategory%>%filter(category=="Card Game"|category=="Expansion for Base-game"|category=="Wargame"|category=="Fantasy"|category=="Fighting"|category=="Science Fiction")
  
#boxplot
firstSixCa%>%
  ggplot(aes(x=category, y=average_complexity))+# categorical on x, quantitative on y
  geom_boxplot(color = 'cadetblue4')+
  coord_flip()+
  labs(y = 'average complexity', x = 'categories of games')+
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, face = "bold"),
        plot.title = element_text(hjust = 0.5,
                                  face = "bold",
                                  size = 14))+
        theme_minimal() 
```

>Viualization two(maybe the average rating and users rated)

```{r,echo=FALSE,message=FALSE,warning=FALSE}
newFull_gb %>%
  ggplot(aes(x = users_rated, y = average_rating)) +
  labs(y = 'average rating', x = 'the number of users rated') +
  geom_smooth(method = 'lm')+
  #take 5 points to complete a blue dot and add color to it
  geom_point(color = 'steelblue',alpha=1/5) +
  theme(plot.title = element_text(hjust = 0.5,
                                  face = "bold",
                                  size = 14))+
  theme_minimal() 
```

>Visualtion three(games that published in each year)

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#print(max(newFull_gb$yearpublished))
newFull_gb %>%
  ggplot(aes(x = yearpublished)) +
  labs(y = 'number of games published', x = 'years published') +
  #change the interval into 5 years each
  scale_x_continuous(breaks = seq(1950, 2020, by = 5)) +
  geom_histogram(binwidth = 5) +
  theme(plot.title = element_text(hjust = 0.5,
                                  face = "bold",
                                  size = 14)) +
  theme_minimal()
```

>Visualization four(maybe compare the maxplaytime and game type)

```{r,echo=FALSE,message=FALSE,warning=FALSE}
newFull_gb %>%
  ggplot(aes(x = maxplaytime)) +
  geom_histogram(binwidth = 20, position = "identity", alpha = 0.4, fill = "steelblue") + 
  labs(x = 'maximum time of playing') + 
  facet_grid(. ~ game_type) + 
  xlim(0, 400) +
  theme(plot.title = element_text(hjust = 0.5,
                                  face = "bold",
                                  size = 14)) +
  theme_minimal()
```

>Visualization five(maybe using stacked bar plot compare two category of games within years )

```{r,echo=FALSE,message=FALSE,warning=FALSE}

```

>Visualization six(cateogory and mechanism)

```{r,echo=FALSE,message=FALSE,warning=FALSE}
# Numerical summary (conditional distribution - conditioning on outcome)
newFull_gb %>%
    count(category, mechanic) %>%
    group_by(category) %>%
    mutate(relfreq = n / sum(n)) 
# Numerical summary (conditional distribution - conditioning on smoker)
newFull_gb %>%
    count(category, mechanic) %>%
    group_by(mechanic) %>%
    mutate(relfreq = n / sum(n)) 
# stacked bar plot

```

#Conclusion

# Code Appendix
```{r,eval=FALSE}
#all the code in here
```
